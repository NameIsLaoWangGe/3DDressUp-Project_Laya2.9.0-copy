{
  "code": "import { Admin, DataAdmin, StorageAdmin, TimerAdmin, Tools } from \"./Lwg\";\r\nimport { _MakeTailor } from \"./_MakeTailor\";\r\nimport { _Res } from \"./_PreLoad\";\r\nexport var _DressingRoom;\r\n(function (_DressingRoom) {\r\n    let _Event;\r\n    (function (_Event) {\r\n        _Event[\"changeCloth\"] = \"_DressingRoom_ChangeCloth\";\r\n    })(_Event = _DressingRoom._Event || (_DressingRoom._Event = {}));\r\n    class _Clothes extends DataAdmin._Table {\r\n        constructor() {\r\n            super(...arguments);\r\n            this._classify = {\r\n                DIY: 'DIY',\r\n                General: 'General',\r\n            };\r\n            this._part = {\r\n                Dress: 'Dress',\r\n                Top: 'Top',\r\n                Bottoms: 'Bottoms',\r\n                FaceMask: 'FaceMask',\r\n                Accessories: 'Accessories',\r\n                Shoes: 'Shoes',\r\n                Hair: 'Hair',\r\n            };\r\n            this._otherPro = {\r\n                putOn: 'putOn',\r\n                part: 'part'\r\n            };\r\n        }\r\n        static _ins() {\r\n            if (!this.ins) {\r\n                this.ins = new _Clothes('ClothesGeneral', _Res._list.json.GeneralClothes.dataArr, true);\r\n                this.ins._Scene3D = _Res._list.scene3D.MakeClothes.Scene;\r\n                this.ins._Role = this.ins._Scene3D.getChildByName('Role');\r\n                this.ins._Root = this.ins._Role.getChildByName('Root');\r\n                this.ins._DIY = this.ins._Root.getChildByName('DIY');\r\n                this.ins._General = this.ins._Root.getChildByName('General');\r\n                this.ins._DBottoms = this.ins._DIY.getChildByName('Bottoms');\r\n                this.ins._DTop = this.ins._DIY.getChildByName('Top');\r\n                this.ins._DDress = this.ins._DIY.getChildByName('Dress');\r\n                this.ins._GBottoms = this.ins._General.getChildByName('Bottoms');\r\n                this.ins._GTop = this.ins._General.getChildByName('Top');\r\n                this.ins._GDress = this.ins._General.getChildByName('Dress');\r\n            }\r\n            return this.ins;\r\n        }\r\n        changeClass(classify, partArr) {\r\n            const _classify = this._Root.getChildByName(classify);\r\n            for (let i = 0; i < _classify.numChildren; i++) {\r\n                const _classifySp = _classify.getChildAt(i);\r\n                _classifySp.active = false;\r\n                for (let j = 0; j < partArr.length; j++) {\r\n                    const obj = partArr[j];\r\n                    if (obj[this._otherPro.part] === _classifySp.name) {\r\n                        _classifySp.active = true;\r\n                        for (let k = 0; k < _classifySp.numChildren; k++) {\r\n                            const cloth = _classifySp.getChildAt(k);\r\n                            if (cloth.name === obj[this._property.name]) {\r\n                                cloth.active = true;\r\n                                if (!cloth.skinnedMeshRenderer.material) {\r\n                                    cloth.skinnedMeshRenderer.material = new Laya.BlinnPhongMaterial();\r\n                                }\r\n                                Laya.Texture2D.load(`Game/UI/DressingRoom/ClothTex/${cloth.name}.png`, Laya.Handler.create(this, function (tex) {\r\n                                    cloth.skinnedMeshRenderer.material.albedoTexture = tex;\r\n                                }));\r\n                            }\r\n                            else {\r\n                                cloth.active = false;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        changeAll() {\r\n            const arr = this._getArrByProperty(this._otherPro.putOn, true);\r\n            this.changeClass(this._classify.DIY, arr);\r\n            this.changeClass(this._classify.General, arr);\r\n        }\r\n        startSpecialSet() {\r\n            if (StorageAdmin._bool('DressState').value) {\r\n                this._GBottoms.active = this._GTop.active = this._DBottoms.active = this._DTop.active = false;\r\n            }\r\n            else {\r\n                this._GDress.active = this._DDress.active = false;\r\n            }\r\n        }\r\n        specialSet(part) {\r\n            if (part === this._part.Dress) {\r\n                this['DressState'] = true;\r\n            }\r\n            else if (part === this._part.Top || part === this._part.Bottoms) {\r\n                this['DressState'] = false;\r\n            }\r\n            if (this['DressState']) {\r\n                this._GBottoms.active = this._GTop.active = this._DBottoms.active = this._DTop.active = false;\r\n            }\r\n            else {\r\n                this._GDress.active = this._DDress.active = false;\r\n            }\r\n            StorageAdmin._bool('DressState').value = this['DressState'];\r\n        }\r\n    }\r\n    _DressingRoom._Clothes = _Clothes;\r\n    class _Item extends Admin._ObjectBase {\r\n        lwgButton() {\r\n            this._btnUp(this._Owner, (e) => {\r\n                const arr = _Clothes._ins()._getArrByProperty('part', this._Owner['dataSource']['part']);\r\n                for (let index = 0; index < arr.length; index++) {\r\n                    const element = arr[index];\r\n                    if (this._Owner['dataSource']['name'] === element['name']) {\r\n                        element['putOn'] = true;\r\n                    }\r\n                    else {\r\n                        element['putOn'] = false;\r\n                    }\r\n                }\r\n                _Clothes._ins()._refreshAndStorage();\r\n                _Clothes._ins().changeAll();\r\n                _Clothes._ins().specialSet(this._Owner['dataSource']['part']);\r\n            }, null);\r\n        }\r\n    }\r\n    class DressingRoom extends Admin._SceneBase {\r\n        lwgOnAwake() {\r\n            let DIYArr = _MakeTailor._DIYClothes._ins()._getArrByNoProperty(_MakeTailor._DIYClothes._ins()._otherPro.icon, \"\");\r\n            let copyDIYArr = Tools._ObjArray.arrCopy(DIYArr);\r\n            _Clothes._ins()._addObjectArr(copyDIYArr);\r\n            _Clothes._ins()._List = this._ListVar('List');\r\n            _Clothes._ins()._List.array = _Clothes._ins()._getArrByClassify(_Clothes._ins()._classify.DIY);\r\n            this._ImgVar('DIY').skin = `Game/UI/Common/kuang_fen.png`;\r\n            const Icon = this._ImgVar('DIY').getChildAt(0);\r\n            Icon.skin = `Game/UI/DressingRoom/ClassIcon/${this._ImgVar('DIY').name}_s.png`;\r\n            _Clothes._ins()._listRender = (Cell, index) => {\r\n                let data = Cell.dataSource;\r\n                let Icon = Cell.getChildByName('Icon');\r\n                const Board = Cell.getChildByName('Board');\r\n                if (data[_Clothes._ins()._otherPro.putOn]) {\r\n                    Board.skin = `Game/UI/Common/xuanzhong.png`;\r\n                }\r\n                else {\r\n                    Board.skin = null;\r\n                }\r\n                if (data[_Clothes._ins()._property.classify] === _Clothes._ins()._classify.DIY) {\r\n                    Icon.skin = data[_MakeTailor._DIYClothes._ins()._otherPro.icon];\r\n                }\r\n                else {\r\n                    Icon.skin = `Game/UI/DressingRoom/Icon/${data[_Clothes._ins()._property.name]}.png`;\r\n                }\r\n                if (!Cell.getComponent(_Item)) {\r\n                    Cell.addComponent(_Item);\r\n                }\r\n            };\r\n        }\r\n        lwgEvent() {\r\n            this._evReg(_Event.changeCloth, () => {\r\n            });\r\n        }\r\n        lwgOnStart() {\r\n            this.UI = new _MakeTailor._UI(this._Owner);\r\n            TimerAdmin._frameOnce(10, this, () => {\r\n                this.UI.operationAppear();\r\n                this.UI.btnBackAppear(null, 200);\r\n                this.UI.btnCompleteAppear(null, 400);\r\n            });\r\n            this.UI.btnCompleteClick = () => {\r\n                this.UI.operationVinish(() => {\r\n                    this.UI.btnBackVinish(() => {\r\n                        this._openScene('Start', true, true);\r\n                    });\r\n                }, 200);\r\n            };\r\n        }\r\n        lwgButton() {\r\n            for (let index = 0; index < this._ImgVar('Part').numChildren; index++) {\r\n                const _element = this._ImgVar('Part').getChildAt(index);\r\n                this._btnUp(_element, () => {\r\n                    let arr = [];\r\n                    for (let index = 0; index < this._ImgVar('Part').numChildren; index++) {\r\n                        const element = this._ImgVar('Part').getChildAt(index);\r\n                        const Icon = element.getChildAt(0);\r\n                        if (_element === element) {\r\n                            element.skin = `Game/UI/Common/kuang_fen.png`;\r\n                            Icon.skin = `Game/UI/DressingRoom/PartIcon/${element.name}_s.png`;\r\n                            if (_element.name === 'DIY') {\r\n                                arr = _Clothes._ins()._getArrByClassify(_element.name);\r\n                            }\r\n                            else {\r\n                                let _arr = _Clothes._ins()._getArrByClassify(_Clothes._ins()._classify.General);\r\n                                for (let index = 0; index < _arr.length; index++) {\r\n                                    const obj = _arr[index];\r\n                                    if (obj[_Clothes._ins()._otherPro.part] === _element.name) {\r\n                                        arr.push(obj);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        else {\r\n                            element.skin = `Game/UI/Common/kuang_bai.png`;\r\n                            Icon.skin = `Game/UI/DressingRoom/PartIcon/${element.name}.png`;\r\n                        }\r\n                        _Clothes._ins()._List.array = arr;\r\n                    }\r\n                }, 'no');\r\n            }\r\n        }\r\n    }\r\n    _DressingRoom.DressingRoom = DressingRoom;\r\n})(_DressingRoom || (_DressingRoom = {}));\r\nexport default _DressingRoom.DressingRoom;\r\n",
  "references": [
    "D:/Game/project/3DDressUp/Copy/3DDressUp_Laya2.9.0/3DDressUp_Laya2.9.0/src/script/Lwg/Lwg.ts",
    "D:/Game/project/3DDressUp/Copy/3DDressUp_Laya2.9.0/3DDressUp_Laya2.9.0/src/script/Lwg/_MakeTailor.ts",
    "D:/Game/project/3DDressUp/Copy/3DDressUp_Laya2.9.0/3DDressUp_Laya2.9.0/src/script/Lwg/_PreLoad.ts",
    "D:/Game/project/3DDressUp/Copy/3DDressUp_Laya2.9.0/3DDressUp_Laya2.9.0/src/script/Lwg/_PropTry.ts"
  ]
}
